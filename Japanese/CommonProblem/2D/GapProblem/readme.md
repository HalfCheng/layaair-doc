#WebGLは写真をつなぎ合わせて隙間の問題を生みます。

**LayaAirエンジンの中でもしレンダリングモードがWebGLを採用すると、写真のつなぎ目によく隙間ができます。下図のように：**

![1](img/1.png)
(図1)

###隙間ができる原因：

1）3 D世界の中半分の画素の問題、WebGLはグラフィックカードのハードウェアを採用してレンダリングを加速し、テクスチャを描くのはUVと画像のピクセル値で位置合わせする方法、及びWebGLの中のアドレス指定方法などです。（この文章では半ピクセルの資料を説明しすぎないので、興味があるならgoogleで調べてみてもいいです。）

2）2 Dにおけるリソースがスケーリングまたは拡大縮小を伴う場合、このギャップは精度の問題でより顕著に現れる。

###エンジン中の画面処理方式：

LayaAirエンジンには二つのセットを包装する方法があります。一つは、直接UI編集モードでリソースを導出することであり、一つはツールバーのセット包装ツールを使ってパッケージ化することである。しかし、この2つの機能は同じことをしています。図を図集にまとめると、保護辺が追加されます。下の図のように、

![2](img/2.png)
(图2)


**（緑の部分は最端の画素を表します）**

一枚の大きな図にマージすると、位置は100,100です。大図に合併すると自動的に最端の画素を拡充しますが、本当に描画する場合は100,100の位置をとります。隙間を避けることができます。

![3](img/3.png)
(図3)

**（青い部分は拡充された辺で、この辺の画素値は図2のエッジ値をコピーする）**

###つなぎ合わせの地図はどうやって修正しますか？

上で説明した原理を通して、みんなはすべて理解したはずです。しかし、多くのシーンは第三者ツールでつなぎ合わせられています。例えば、Tiled-Mapを使っています。

**Tiled-Mapはこのような保護辺をしていません。どうすればいいですか？**

最も簡単な方法は、サンプリング時に、シーン要素が64＊64の格子であるようなピクセル値を縮小することであり、描かれたコードは以下の通りである。


```typescript

drawImage(image,sx,sy,sw,sh,dx,dy,dw,dh);
```


もともとは次のように書きました。


```typescript

drawImage(image,128,256,64,64,100,100,64,64);//这种写法就可能会出现缝隙
```


現在は次のように変更する必要があります。


```typescript

drawImage(image,128+1,256+1,64-1,64-1,100,100,64,64);
```


つまりサンプリングする時は資源を一回り縮小しますが、描く時は64ぐらいの大きさです。ほとんどのこのような処理方法は見えません。

しかし、より良い効果が欲しいなら、美術の工夫が必要です。例えば、絵の要素を描く時は、もう保護しながら描きました。









