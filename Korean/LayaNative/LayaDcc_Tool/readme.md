#LayaDCC 도구

##소개하다
LayaDCC:Laya-Dynamic Conent Check, LayaPlayer 가 제공하는 열갱신 해결 방안입니다.그 장점은 운행 시 차이 업데이트, 인터넷 흐름을 효과적으로 줄이는 것이다.그의 주요 데이터는 DCC 파일, DCC 파일이 프로젝트의 모든 파일을 묘사하는 데 사용된다.DCC 파일은 도구 layadcccc를 통해 발생했습니다.

layadcc 는 모든 항목 파일을 두루 옮겨다니며 모든 파일을 포함한 디바이스 파일 filetable.bin 생성합니다.LayaPlayer 가 시작할 때 서버에서 이 파일을 가져옵니다 (필요하면) 파일을 갱신해야 할지 확인하십시오.

layadcc 는 자원 가방을 생성할 수 있으며 자원을 Appp에 포함시키는 데 사용된다.

##LayaPlayer 자원 가방 종류
현재 자원 포장 방안은 세 가지가 있다.
일.####App 인터넷 가방:

App 은 그 자체에 아무런 자원도 가지고 있지 않고 부피가 가장 작다.
LayaPlayer 가 처음으로 실행할 때 모든 자원을 서버에서 다운로드하고, 이 지역에 버틸 수 있습니다.두 번째 및 이후 실행 시 서버에서 dccc 파일을 가져오고, 다음, 이 파일을 다운로드할 때, 로컬 자원이 갱신되어야 하는지 확인하고, 갱신할 때만 진정으로 다운로드하고, 업데이트되지 않은 자원은 직접 로컬 캐시 파일로 읽는다.
로컬 캐시가 점점 커질 것이다.

이.####자원을 가져온 App 망 패키지:

Appp가방은 부분이나 모든 게임 자원을 포함해 가방 부피가 크다.
데이터가 여전히 업데이트를 할 수 있으며, 실행할 때마다 서버에서 dccc 파일을 검사합니다. 만약 가방에 있는 파일이 이미 낡았다면, 새로운 파일을 다운로드하고, 나중에 실행할 때, 캐시 파일만 고치지 않으면 여전히 유효하게 사용됩니다.
여러 번 업데이트한 후 App 백의 파일은 대부분 잘못되었을 수도 있으며, 매번 찾는 로컬 캐시, 이때 Appp백을 새로 업데이트하고 새 자원으로 포장하는 것을 권장합니다.

삼.####App 이선 패키지 (클러치):

모든 자원을 App 에 직접 싸서 네트워크를 다운로드할 필요는 없고 인터넷도 필요 없다.부피가 가장 크다.
단기 버전으로 url 이 없어 자원 동태를 업데이트할 수 없어 자원을 업데이트하려면 앱을 업데이트할 수밖에 없다.

##설치 및 layadcc 사용
layadcc 는 Node.js 기반, Node.js 환경이 필요합니다.
###1. Node.js 설치
nodejs[官网](https://nodejs.org/en/)다운로드
node.js 너무 늙으면 안 되고 0.xx 버전을 지원하지 않으면 명령으로 node 버전을 볼 수 있다
예를 들어:

```bash

$ node -v
v4.2.0
```

이 버전은 가능하다.
###2. layadcc 설치

```bash

npm install -g layadcc
```

잘 설치되면 명령행에서 바로 layadcccc를 수행할 수 있습니다.

###3. 사용 방법


```

layadcc 资源目录 [options]
options:
    -cache 生成资源包.
    -lwr 文件路径全部转为小写。（一般不需要）
    -url url 如果要打包资源的话，对应的url.
    -cout outpath 打包资源的输出目录，如果不设置的话，就是在资源目录下。
例如:
   layadcc d:/game/wow -cache -url www.game.com
```

###4. 실전 조작
####환경 실행
Node.js, npm, layadcc
검증 방법:
[] (img/2.png)
도
layadccc를 실행하는 데 오류가 없으면 됩니다.

####4.2 html5 프로젝트 환경
이 디렉토리에 게임 항목을 설정합니다. F: work / test / bestgame / bestgame / 디렉토리 아래에 놓습니다.
[] (img/3.png)
도2
이 항목이 발표된 후 대응하는 url 주소는:`http://www.layabox.com/bestgame/index.html`  
(단기판에서 url 주소가 필요 없다면)

####가방 자원
현재 이 html5 항목을 포장하여 Appp에 넣어야 합니다.

```

 layadcc F:/work/test/bestgame -cache -url http://www.layabox.com/bestgame/index.html
```

싱글 가방이라면 입력:

```

 layadcc F:/work/test/bestgame -cache -url http://stand.alone.version/index.html
```


다음 그림:
[] (img/2.gif)
도

더하다`-cache`인자 후에 모든 자원 파일을 따라 출력할 수 있습니다`-cout`지정한 디렉토리 아래, 없다면`-cout`로그 디렉토리 아래에 layadccout 디렉토리를 생성합니다. (상도) 출력 디렉토리 아래에 있는 cache 디렉토리는 Appp을 작성할 때 사용해야 할 자원입니다.
그리고 이 디렉토리를 구축된 프로젝트의 대응 디렉터리에 번역하여 Appp로 생성할 수 있습니다.
다른 개발 환경 아래에서 다른 디렉토리 (Layairide 또는 라yabox 명령행 도구를 사용하면 자동으로 완성할 수 있다.

**앤드로이드 Eclipse:**  
![1](img/1.jpg) <br />

(그림 4) android 의 자원 디렉토리는 프로젝트 아래 asets 디렉토리다

**앤드로이드 스튜디오:**  
[] (img/5.png)
(그림 5)

**iOS XCode:**  
![2](img/2.jpg)< br />
(도 6) 아이오스는 resource 디렉터리입니다.

####4.4 업데이트 서버
이것은 App 의 발표 후 가장 흔한 조작이다.html5 항목의 내용을 업데이트할 때마다 서버나 로컬 테스트를 제출할 때 새 dcccccc가 생성되어야 합니다.작업 과정은 아래와 같다:
[] (img/1.gif)
도

layadcc 를 실행한 후 지정 디렉토리 (현재 경로입니다.) 다음에는 update 디렉터리가 생성됩니다.그리고 이 update 디렉터리를 로컬 혹은 원격 서버의 같은 디렉터리를 복사하면 됩니다.
**Tips:**   
편리와 오류가 발생하지 않기 위해서 서버의 목록에서 레이야accc 실행할 것을 건의합니다.

**update 디렉터리 소개:**   
[] (img/4.png)
도

allfiles.txt 모든 자원 파일의 상대적인 경로.
asetsid.txt 이번 dccc 통계된 전체 자원 가방 검사 코드입니다.
filetable.bin dcc 메인 파일, 모든 파일의 검사치입니다.
filetable.txt 텍스트 형식의 dcc 파일을 제외하고 모든 파일과 대처한 검사치로 allfiles.txt 와 잘 맞출 수 있는 파일이 allfiles.txt
filetable1.txt 이 파일은 사용하지 않습니다.

**注意:**  
1. 웹 서버의 디렉토리 안에 update 디렉토리가 없다면, update 디렉터리가 없었을 경우 클라이언트 dccc가 업데이트 메커니즘을 닫게 되면 모든 자원이 다시 다운로드됩니다.개발 기간에 이런 방식을 건의합니다.
2. 위의 예는 현재 디렉토리 아래에서 실제로 다른 경로를 지정할 수 있으며, 상대 또는 절대 가능합니다.
   `layadcc d:/game/bin/h5`혹은`layadcc ../bin/h5`


####4.5 테스트
1. 자원 패키지 성공 테스트
먼저 가방에 자원이 없는 상황을 말하자면 이러한 상황에서 모든 자원이 인터넷에서 다운로드되고 로그는 다음과 같습니다.
[] (img/7.png)
그림 9 가 많은 Download 를 볼 수 있어요.
   **인쇄 정보 설명:**  
이 안에 url 뒤에 따라 있는 @127.0.0.1은 디버깅으로 이 파일에 대한 서버 주소를 표시합니다.s = 0 은 이 파일이 dcc 정보가 없습니다. l = xxx 가 다운로드한 파일의 길이를 표시합니다.

만약 자원 가방을 썼다면, 즉 cache 디렉터리가 위에 지정된 디렉터리를 복사하였을 때 가장 직관적인 변화는 가방이 커졌다.그리고 app 을 실행하려면 자원 가방에서 자원을 읽는 인쇄가 있습니다. 다음과 같습니다.
[] (img/8.png)
도
   **打印信息说明**  
인쇄`found the file in the package:`해당 자원은 가방에서 얻은 것이며 인터넷에 다운로드하지 않고 이 로그를 보고 자원 성공을 표시했다.만약 출력된 단기판이라면 모든 자원은 이 인쇄가 있어야 하며, 다운로드가 없어야 한다.

2. 서비스에 dcc 테스트가 있는지 여부:
브라우저에서 주소를 열기: http://www.layabox.com/bestgame/update/filetable.txt
자신의 주소로 변경하려면 파일이 존재한다면 dcccc를 쳤음을 표시합니다.다음 그림:
[] (img/6.png)
도

3. 메커니즘을 업데이트 하는 테스트
직관적인 테스트는 자원을 갱신하고, App 에 대응하는 변화가 생기고, 예를 들어 수정된 그림은 app 에서 볼 수 있다.로그 를 보면 자원 이 얻을 때, 변화 가 없는 것 은 모두 인쇄 이다`found the file in the package:`바뀐 것은 모두 인쇄`download [ ] xxxurl `.
   **注意**  
1 Download 는 한 번만 실행하고, 두 번째는 app 에 들어간다. 이 자원은 고치지 않았다면 캐시에서 직접 사용한다.
2 DCCC의 메커니즘은 실행 시 업데이트하기 때문에 이 자원이 필요할 때만 다운로드하는 것이 아니라 모든 업데이트를 다운로드합니다.


**总结**  
*다 있다`download [ ] url `다운로드, dcc 또는 자원 업데이트
*다 있다`found the file in the package:`포장 자원 성공, dcc 역할


**주의:**  
* layadccc 실행할 때 모든 파일의 수정 시간을 수정할 것입니다. cdn 이 원본을 방지하기 위해서 파일이 수정되지 않았다고 생각했습니다.
* 위의 주소는 허구로 http: / www.layabox.com/bestgame/index.html 주소가 없습니다.


##흔한 문제
1. 자원을 포장한 후 속도가 빨라지지 않고 모든 자원을 다운로드하고 있다.
1. 정말 다운로드 여부는 다운로드, 로그는 위에서 언급한 Download, find, 읽기, 다운로드, 다운로드, 다운로드, 정말 느린 다운로드.
2. 모두 Download, 캐시를 읽지 않았다면
1. dccc를 잊어버린 것이 아니라 브라우저를 통해 서버에 dccccc가 있는지 확인하는 것이 좋습니다.
2. 자원 경로가 올지 체크.

2. App 이 발표된 후 일부 자원을 수정했지만 App에 업데이트되지 않았다.
1. dcccc를 까먹은 거 아니야?
2. dcccc를 쳤지만 서버에 제출하는 것을 잊었다. (서버에서 dcc)
3. dccc를 때렸고 서버에 제출했지만, cdn 이 있었기 때문에 이 변화를 당신이 있는 노드 로 나눠주지 않았다.

3. dcc 프로세스를 확인하지만, 어떤 자원은 매번 다시 다운로드하고, 캐시를 하지 않는다.
1. 이 자원은 프로토콜 자원에 있는지 확인하고, 즉 dcc 목록에서 update / allfiles.txt 에서 이 파일을 검색할 수 있습니다.
2. 혹시 있으면.이 자원을 요청하는 url 은 search 부분이 있는지 확인하는 것인지, 즉? xxx, 만약 더하면 dcc 흐름을 걷지 못할 것입니다.
3. 세르치도 없다면 이 파일의 실제 내용과 일치하지 않을 수도 있다. dcccc는 잘못된 파일인 줄 알고, 버틸 수 없다.가능한 이유:
1. dccc를 마친 후 이 파일의 내용을 다시 바꾸어 dcc 검사치와 실제 파일의 내용이 맞지 않습니다.해결 방법: dcc 다시
2. 파일을 바꾸는 사람은 없지만 dcc 는 클라이언트에 올렸고 파일은 서버에 올린 후, 소프트웨어 수정 내용을 올렸습니다.이러한 경우 일반 텍스트 파일에서 발생합니다. 예를 들어 일부 버전 관리 도구와 ftp 공구는 windows 아래의 환차로 유닉스의 회차로 변합니다.해결 방법: zip 방식으로 파일을 전달하거나 서버에 dcccccc를 합니다.
3. 위에 문제가 없고 잘못된 것은 그림이다.일부 시스템은 http 요청을 전역에서 압축된 시스템이 있을 수 있으며, 그림을 요청할 때, 자신의 서버를 통해 압축된 그림을 캐시, 이른바 절약량에 달할 수 있다.이 압축된 그림의 검사치는 틀림없이 dccccc기록과 다를 것이다.해결 방법: 데이터 절감 기능을 끄세요.
4. 열량이 없으면 절약한다.그러나 cdn 을 사용하면 cdn의 문제일 수도 있으며, 예를 들어 dcc 파일이 새로 고쳐졌지만, 지원된 자원 파일은 새로 고쳐지지 않았다.확인 방법: curl 명령을 통해 본 노드를 다운로드하는 자원 파일 (방법이 부록) 과 비교해 원소 자원 파일과 비교하면 확인합니다.해결 방법: cdn 노드를 강제 쇄신하거나 cdn 고객을 찾습니다.

4. 개발기간에 번갈아 업데이트할 때마다 dcccc를 귀찮게 한다.
layadccc로 dccc를 때리지 말고 이미 때렸다면
update 디렉터리를 삭제한 후 app 을 다시 설치하여 내부 캐시 제거를 위해 dcc 메커니즘을 끄고 모든 파일의 요청을 다시 다운로드합니다.
한 번 다시 dcc 를 쳤다면 서버 엔드에서 update 디렉터리를 생성한다면 캐시 또한 작용할 수 있다. 끄고 싶다면 위에 동작을 한 번 더 해보자.

5. 가방의 부피를 줄이기 위해 일부 자원을 포장하기 위해 정확한 자세는 무엇일까?
처음 설치하든 앞으로 app 을 업그레이드하거나 일부 자원에만 있는 dcccccc정보는 완전한 데이터를 바탕으로 생성할 수 있습니다.예를 들어 총 100개의 자원이 있습니다. 50개에서 appp을 만들고 싶다면, 완전한 자원 상태에서 dcccccccc를 저장하고 있는 dcc 정보(주로 filetable.txt), 그리고 50개의 자원을 삭제하고, layadccccc 생성 cache 파일을 생성할 때, 이때 cache 목록에서 dcccccccc로 생성된 파일을 완성할 수 있습니다.
완전하지 않은 dcc 를 사용하면 발생하는 문제: app 을 업데이트할 때, native ap에서 캐시 파일을 우선적으로 사용할 dcc 파일을 사용하여 일부 캐시 정보를 잃어버릴 수 있으며, filetable.txt 파일이 캐시 파일을 캐시 없이 다운로드할 수 있으며, 다음 서버 dcccccccc 업데이트할 때까지 다운로드합니다.

##부록
1. 레이디 CC 프로세스
[] (img/1.png)
도
대응하는 코드 index.js 중.

2. 어떤 cdn 노드 파일을 다운로드합니다.

```sh

curl -H "Host:www.layabox.com" http://182.110.238.110/bestgame/index.html >a.html
```

182.110.238.110 노드`http://www.layabox.com/bestgame/index.html`파일을 다운로드하여 a.html 안에 저장합니다.
그 중 Host: 뒤의 내용은 도메인 이름으로 바꾸고,`http://`뒤에 ip 주소가 노드 서버의 주소로 변경되었는데 어떻게 노드 서버 주소를 획득합니까?LayaPlayer 에서 노드 서버는 일반적으로 바뀌지 않기 때문에 Download 인쇄를 통해 주소를 얻을 수 있습니다.

```

Downloaded http://www.layabox.com/bestgame/bestgame.min.js@182.110.238.110 s=44216b56 l=422
```

노드 주소가 182.110.238.110.110.