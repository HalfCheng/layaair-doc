#Android File Extension Mechanism
LayaNative not only supports packaging resources in assets directory, but also supports packaging resources into ZIP files and placing them in any file path. The LayaNative filesystem first looks for the existence of the file in the assets directory, and if it does not, then goes to the zip path specified. Through this zip mechanism, we can solve the problem that the size of APK is more than 100MB and the extension package is required by Google Play.

##1. Detailed mechanism
###1. generate DCC
Test project packages resources with DCC tools
![图1](img/1.jpg)    

###2. Compressed files
Put the resource bundle in the extended file, compress the cache file. The file requires zip format. The file structure must be the same as that generated by DCC tools. The following figure shows:
![图1](img/2.jpg)  

###3. Copy zip files to device directory
Create a directory / storage / emulated / 0 / Android / test / com. layabox. conch6 on your Android phone and upload test. zip to this directory
###4. Modify the extension path in the code
Modify RuntimeProxy. Java`getExpansionMainPath`Function to set the correct zip path.

```

    public String getExpansionMainPath()
    {
        return "/storage/emulated/0/Android/test/com.layabox.conch6/test.zip";
    }
    public String getExpansionPatchPath()
    {
        return "";
    } 
```

###5. Open External Storage Permissions
Machines over Android 6.0 may not be able to read external storage and need to actively request permissions. Please add the following code or Google related solutions.

```

    public static boolean isGrantExternalRW(Activity activity) {
        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.M && activity.checkSelfPermission(
                Manifest.permission.WRITE_EXTERNAL_STORAGE) != PackageManager.PERMISSION_GRANTED) {
            activity.requestPermissions(new String[]{
                    Manifest.permission.READ_EXTERNAL_STORAGE,
                    Manifest.permission.WRITE_EXTERNAL_STORAGE
            }, 1);
            return false;
        }
        return true;
    }
```

**TIPS: LayaNative supports up to two zip files, and the second zip modifies the function getExpansionPatchPath.**

###5. Running test
Running APP, you see the following log showing that the resource file was successfully read from the main extension package
![图1](img/3.png)  

##2. Google Play APK Extension File Mechanism
(https://developer.android.com/google/play/expansion-files.html)
